<!DOCTYPE html>
<meta charset="utf-8">
<html>

<head>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&family=Ubuntu:wght@300&display=swap"
    rel="stylesheet">

  <script src="js/features.js" type="text/javascript"></script>
  <script src="js/happiness.js" type="text/javascript"></script>
  <script src="js/country.js" type="text/javascript"></script>

</head>

<!-- Load d3.js -->
<script src='https://d3js.org/d3.v5.min.js'></script>
<script src="https://d3js.org/d3.v4.js"></script>



<script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>

<h1 style="margin-left: 60px; font-family: 'Ubuntu', sans-serif">World Happiness!</h1>

<!-- Buttons for Navigation -->
<div style="margin-bottom: 30px; margin-left: 60px;" id="buttons">
  <!--    <button onclick="update('Generosity')" id = ">Generosity</button> -->
  <button id="b_summary" style="font-family: 'Ubuntu'; font-size: 20px;">Summary</button>
  <button id="b_parameters" style="font-family: 'Ubuntu'; font-size: 20px;">Happiness Parameters</button>
  <button id="b_country" style="font-family: 'Ubuntu'; font-size: 20px;">Happiness per Country</button>
</div>


<!-- Buttons to Select the Attribute -->
<div style="margin-bottom: 30px; margin-left: 60px;" id="par_buttons">
  <!--    <button onclick="update('Generosity')" id = ">Generosity</button> -->
  <button id="b_gdp" style="font-family: 'Ubuntu'; font-size: 20px;">Log GDP per capita</button>
  <button id="b_ss" style="font-family: 'Ubuntu'; font-size: 20px;">Social Support</button>
  <button id="b_cur" style="font-family: 'Ubuntu'; font-size: 20px;">Corruption</button>
  <button id="b_fre" style="font-family: 'Ubuntu'; font-size: 20px;">Freedom to make life
    choices</button>
</div>

<!-- Create a div where the graph will take place -->

<div id="tooltip"></div>



<div style="width:100%"></div>
<div style="width:70%; float:left" id="my_dataviz"></div>
<div>
  <select style="font-family: 'Ubuntu'; font-size: 20px; float:left" id="chooseCountry"></select>
</div>
<div style="width:25%; float:left" id="text_idv">
  <h2 style="font-family: 'Ubuntu', sans-serif" id="sideTextTitle">Great! Let's do it</h2>
  <p style="font-family: 'Ubuntu', sans-serif; font-size: 15px;" id="sideText">Let's See if it works!</p>
</div>
</div>



<!-- Initialize a select button -->


<!-- Year Slector Slider -->
<div class="range" style="margin-left: 60px;">

  <input class="slider" type="range" min="2011" max="2020" step="1" id="yearSlider">

  <div class="sliderticks">
    <p>2011</p>
    <p>2012</p>
    <p>2013</p>
    <p>2014</p>
    <p>2015</p>
    <p>2016</p>
    <p>2017</p>
    <p>2018</p>
    <p>2019</p>
    <p>2020</p>
  </div>

</div>



<body>
  <script>


    // let myBubbleChart = bubbleChart();

    var sum_button = d3.select('#b_summary');
    var par_button = d3.select('#b_parameters');
    var country_button = d3.select('#b_country');

    sum_button.style("border-color", "whitesmoke");
    par_button.style("border-color", "whitesmoke");
    country_button.style("border-color", "whitesmoke");

    var firstTime = true;

    if (firstTime == true) {
      showSummary();
      firstTime == false;
    }



    // Show Summary Screen
    function showSummary() {
      par_button.style("border-color", "whitesmoke");
      country_button.style("border-color", "whitesmoke");
      sum_button.style("border-color", "dodgerblue");

      d3.select("#my_dataviz").selectAll("svg").remove();
      d3.select("#par_buttons").transition().duration(1000).style('opacity', 0);
      d3.select("#chooseCountry").transition().duration(1000).style('opacity', 0);
      d3.select("#text_idv").transition().duration(1000).style('opacity', 0);
      d3.select('#yearSlider').transition().duration(500).style('opacity', 1);
      d3.select('.sliderticks').transition().duration(500).style('opacity', 1);
      createBubbleChart();
    }

    function showFeatures() {
      d3.select("#par_buttons").transition().duration(1000).style('opacity', 1);
      d3.select("#chooseCountry").transition().duration(1000).style('opacity', 0);
      d3.select("#text_idv").transition().duration(1000).style('opacity', 1);
      d3.select('#yearSlider').transition().duration(500).style('opacity', 1);
      d3.select('.sliderticks').transition().duration(500).style('opacity', 1);
      d3.select("#my_dataviz").selectAll("svg").remove();

      country_button.style("border-color", "whitesmoke");
      sum_button.style("border-color", "whitesmoke");
      par_button.style("border-color", "dodgerblue");
      createFeatureChart();
    }


    sum_button.on("click", function (d) {
      showSummary();
    });



    par_button.on("click", function (d) {
      showFeatures();
    })


    function showCountry(country) {
      d3.select("#par_buttons").transition().duration(1000).style('opacity', 0);
      d3.select("#chooseCountry").transition().duration(1000).style('opacity', 1);
      d3.select("#text_idv").transition().duration(1000).style('opacity', 1);
      d3.select('#yearSlider').transition().duration(500).style('opacity', 0);
      d3.select('.sliderticks').transition().duration(500).style('opacity', 0);
      d3.select("#my_dataviz").selectAll("svg").remove();

      par_button.style("border-color", "whitesmoke");
      sum_button.style("border-color", "whitesmoke");
      country_button.style("border-color", "dodgerblue");
      createCountryChart(country)
    }

    country_button.on("click", function (d) {
      showCountry('Switzerland');
    })



    // function called once promise is resolved and data is loaded from csv
    // calls bubble chart function to display inside #my_dataviz div
    function display(data) {
      myBubbleChart('#my_dataviz', data);
    }

    // 

  </script>
</body>

</html>